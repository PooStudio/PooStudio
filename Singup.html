<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Application ✦ POOSTUDIO</title>

  <link rel="icon" href="logo.png" type="image/png" />
  <link rel="apple-touch-icon" href="logo.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="signupcss.css" />
</head>

<body>

<div id="loading-screen">
  <div class="loading-content">
    <h1 class="loading-title">POOSTUDIO</h1>
    <p class="loading-text">Loading APPLICATION...</p>
    <div class="loading-bar">
      <div class="loading-progress" id="progress"></div>
    </div>
    <p class="error-message" id="error-message">No Signal.<br>Reconnecting...</p>
    <button id="retry-btn" class="retry-button">RETRY MANUALLY</button>
  </div>
</div>

<div class="container" id="main-content">
  <h1 class="glow-text">DEV / MOD APPLICATION</h1>
  <p class="subtitle">We're looking for talented people. Tell us who you are and why you want to join POOSTUDIO.</p>

  <form id="application-form" 
        action="https://formspree.io/f/mykkgpqq" 
        method="POST">

    <input type="text" name="_gotcha" style="display:none" />

    <input type="hidden" name="_subject" value="New POOSTUDIO Application - {{name}}">

    <div class="form-group">
      <label for="name">FULL NAME / NICKNAME</label>
      <input type="text" id="name" name="name" required placeholder="How should we call you?">
    </div>

    <div class="form-group">
      <label for="email">EMAIL ADDRESS</label>
      <input type="email" id="email" name="email" required placeholder="Where we can reach you">
    </div>

    <div class="form-group">
      <label for="role">ROLE YOU'RE APPLYING FOR</label>
      <select id="role" name="role" required>
        <option value="" disabled selected>Select role...</option>
        <option value="Developer">Developer</option>
        <option value="Moderator">Moderator</option>
        <option value="Both">Both (Dev + Mod)</option>
        <option value="Other">Other (please specify in message)</option>
      </select>
    </div>

    <div class="form-group">
      <label for="discord">DISCORD TAG (optional)</label>
      <input type="text" id="discord" name="discord" placeholder="username#0000 or @username">
    </div>

    <div class="form-group">
      <label for="experience">BRIEF EXPERIENCE / PORTFOLIO LINKS</label>
      <textarea id="experience" name="experience" rows="4" placeholder="Previous projects, skills, GitHub, past moderation experience, etc..."></textarea>
    </div>

    <div class="form-group">
      <label for="why">WHY SHOULD WE CHOOSE YOU? *</label>
      <textarea id="why" name="why" required rows="6" placeholder="Explain why you want to join POOSTUDIO and what makes you stand out."></textarea>
    </div>

    <button type="submit" class="btn" id="submit-btn">SUBMIT APPLICATION</button>
  </form>

  <div class="site-footer">
    <div>© 2026 PooStudio</div>
    <div>
      <a href="privacy.html">Privacy</a> ·
      <a href="terms.html">Terms</a>
    </div>
  </div>
</div>

<a href="index.html" class="home-button">HOME</a>

<script>

const STORAGE_KEY = "poostudio_last_application_time";
const COOLDOWN_KEY = "poostudio_submit_cooldown";
const form = document.getElementById("application-form");
const submitBtn = document.getElementById("submit-btn");

function getNextResetDate(from = new Date()) {
  const d = new Date(from);
  d.setDate(d.getDate() + 1);
  d.setHours(0, 5, 0, 0);
  return d;
}

function formatTimeLeft(ms) {
  if (ms <= 0) return "Now – refresh page";
  const s = Math.floor(ms / 1000);
  const m = Math.floor(s / 60);
  const h = Math.floor(m / 60);
  const d = Math.floor(h / 24);
  const remS = s % 60;
  const remM = m % 60;
  const remH = h % 24;
  let str = "";
  if (d > 0) str += d + "d ";
  if (remH > 0 || d > 0) str += remH + "h ";
  str += remM + "m " + (remS < 10 ? "0" : "") + remS + "s";
  return str.trim();
}

function isOnCooldown() {
  const cd = localStorage.getItem(COOLDOWN_KEY);
  if (!cd) return false;
  return Date.now() < Number(cd);
}

function setCooldown(seconds = 12) {
  localStorage.setItem(COOLDOWN_KEY, Date.now() + seconds * 1000);
}

function showLocked(message = "Next submission available in:", big = false) {
  const nextReset = getNextResetDate();
  form.innerHTML = `
    <div style="text-align:center; padding: ${big ? '6rem' : '4rem'} 1.5rem; color:#aaa;">
      <p style="font-size:${big ? '1.8rem' : '1.4rem'}; margin-bottom:2rem;">
        ${message}
      </p>
      <div id="countdown" style="
        font-size:${big ? '4.2rem' : '3.4rem'};
        font-weight:bold;
        color:#00ffea;
        text-shadow:0 0 18px #00ffea90;
        letter-spacing:3px;
        font-family:'Orbitron',sans-serif;
      ">:::...</div>
      <p style="margin-top:2.5rem; opacity:0.5; font-size:1rem;">
        (one application per day)
      </p>
    </div>
  `;

  const el = document.getElementById("countdown");
  const update = () => {
    const diff = nextReset - new Date();
    if (diff <= 0) return location.reload();
    el.textContent = formatTimeLeft(diff);
  };
  update();
  setInterval(update, 980);
}

function showSuccess() {
  localStorage.setItem(STORAGE_KEY, new Date().toISOString());
  form.innerHTML = `
    <div style="text-align:center; padding:5rem 1.5rem; color:#ddd;">
      <h2 style="color:#00ffea; font-family:'Orbitron',sans-serif; font-size:2.8rem; margin-bottom:1rem; text-shadow:0 0 12px #00ffea70;">
        APPLICATION SENT!
      </h2>
      <p style="font-size:1.3rem; margin:1.5rem 0; opacity:0.9;">
        Thank you! We'll review it soon.
      </p>
      <p style="font-size:1.45rem; margin:2.5rem 0 1rem;">
        Next submission in:
      </p>
      <div id="countdown" style="
        font-size:3.6rem;
        font-weight:bold;
        color:#00ffea;
        text-shadow:0 0 18px #00ffea90;
        letter-spacing:2px;
        font-family:'Orbitron',sans-serif;
      ">:::...</div>
    </div>
  `;

  const nextReset = getNextResetDate();
  const cd = document.getElementById("countdown");
  const tick = () => {
    const diff = nextReset - new Date();
    if (diff <= 0) return location.reload();
    cd.textContent = formatTimeLeft(diff);
  };
  tick();
  setInterval(tick, 980);
}

if (localStorage.getItem(STORAGE_KEY)) {
  showLocked("Next submission available in:", true);
} else if (isOnCooldown()) {
  showLocked("Please wait a moment...", false);
} else {

  form.addEventListener("submit", function(e) {
    if (isOnCooldown()) {
      e.preventDefault();
      alert("Please wait a few seconds before trying again.");
      return;
    }

    submitBtn.disabled = true;
    submitBtn.textContent = "SENDING...";
    setCooldown(12); 

    setTimeout(() => {
      if (!document.getElementById("countdown")) {
        showSuccess();
      }
    }, 6000);
  });

  window.addEventListener("message", function(e) {
    if (e.data && typeof e.data === "string" && 
        (e.data.includes("success") || e.data.includes("Thanks") || e.data.includes("sent"))) {
      showSuccess();
    }
  });
}
</script>

</body>
</html>