window.addEventListener("load", () => {
    document.getElementById("year").textContent = new Date().getFullYear();
    const starsContainer = document.getElementById("starsContainer");
    let idleTimeout;
    const idleTime = 30000; // 30 seconds

    function createStar() {
        const star = document.createElement("div");
        star.classList.add("star");
        star.textContent = 'ðŸ’©'; // Poop emoji for PooStudio theme
        star.style.left = `${Math.random() * 100}vw`;
        star.style.fontSize = `${Math.random() * 20 + 10}px`;
        star.style.animationDuration = `${Math.random() * 2 + 1}s`;
        starsContainer.appendChild(star);
        setTimeout(() => {
            star.remove();
        }, 3000);
    }

    function startStars() {
        starsContainer.style.display = "block";
        const interval = setInterval(createStar, 200);
        return interval;
    }

    function stopStars(interval) {
        clearInterval(interval);
        starsContainer.innerHTML = "";
        starsContainer.style.display = "none";
    }

    let starsInterval;

    function resetIdleTimer() {
        clearTimeout(idleTimeout);
        if (starsInterval) {
            stopStars(starsInterval);
            starsInterval = null;
        }
        idleTimeout = setTimeout(() => {
            starsInterval = startStars();
        }, idleTime);
    }

    window.addEventListener("mousemove", resetIdleTimer);
    window.addEventListener("keydown", resetIdleTimer);
    window.addEventListener("scroll", resetIdleTimer);
    window.addEventListener("touchstart", resetIdleTimer);

    resetIdleTimer();

    // Contact overlay functionality
    const contactBtn = document.getElementById('contactBtn');
    const contactOverlay = document.getElementById('contactOverlay');
    const closeContact = document.getElementById('closeContact');

    contactBtn.addEventListener('click', () => {
        contactOverlay.style.display = 'flex';
    });

    closeContact.addEventListener('click', () => {
        contactOverlay.style.display = 'none';
    });

    // Parallax background movement on mouse move
    window.addEventListener('mousemove', (e) => {
        const width = window.innerWidth;
        const xRel = (e.clientX / width - 0.5) * 2; // -1 to 1
        const bg = document.querySelector('.bg');
        const movingBg = document.querySelector('.moving-bg');
        bg.style.transform = `translateZ(-2px) scale(3) translateX(${xRel * 25}px)`;
        movingBg.style.transform = `translateZ(-1px) scale(2) translateX(${xRel * 15}px)`;
    });
});