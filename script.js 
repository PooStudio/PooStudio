document.addEventListener("DOMContentLoaded", () => {
    // Set current year
    document.getElementById("year").textContent = new Date().getFullYear();

    // Create floating embers
    function createEmber() {
        const e = document.createElement("div");
        e.classList.add("ember");
        e.textContent = "âœ¹"; // Spark symbol
        e.style.left = Math.random() * 100 + "vw";
        e.style.bottom = "-20px";
        e.style.fontSize = (Math.random() * 20 + 15) + "px";
        e.style.animationDuration = (Math.random() * 3 + 3) + "s";
        document.getElementById("embers-container").appendChild(e);
        setTimeout(() => e.remove(), 6000);
    }
    setInterval(createEmber, 300);

    // Easter egg: ember storm
    document.querySelector('.easter-egg').addEventListener('click', () => {
        for (let i = 0; i < 80; i++) {
            setTimeout(createEmber, i * 30);
        }
        alert('The forge erupts! Embers rain upon thee.');
    });

    // Scroll reveal animation
    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                observer.unobserve(entry.target); // Only once
            }
        });
    }, { threshold: 0.2 });

    document.querySelectorAll('section').forEach(sec => observer.observe(sec));

    // Subtle parallax on mouse move
    window.addEventListener('mousemove', e => {
        const x = (e.clientX / window.innerWidth - 0.5) * 30;
        const y = (e.clientY / window.innerHeight - 0.5) * 30;
        document.getElementById('bg-embers').style.transform = `translate(${x}px, ${y}px)`;
    });
});